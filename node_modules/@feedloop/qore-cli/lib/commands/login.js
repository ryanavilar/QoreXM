"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const command_1 = require("@oclif/command");
const user_1 = tslib_1.__importDefault(require("@feedloop/qore-sdk/lib/user"));
const prompts_1 = tslib_1.__importDefault(require("prompts"));
const config_1 = tslib_1.__importDefault(require("../config"));
class Codegen extends command_1.Command {
    async run() {
        const values = await prompts_1.default([
            { name: "email", type: "text", message: "Enter your email" },
            { name: "password", type: "password", message: "Enter your password" }
        ]);
        const user = user_1.default();
        const token = await user.login(values.email, values.password);
        config_1.default.set("token", token);
        const orgs = await user.organizations();
        const defaultOrg = orgs[0].id;
        config_1.default.set("org", defaultOrg);
        this.log(`Logged in as ${values.email}`);
    }
}
exports.default = Codegen;
Codegen.description = "Login to qore cli";
Codegen.examples = [`$ qore login`];
Codegen.flags = {
    email: command_1.flags.string({ char: "p", description: "project id" })
};
