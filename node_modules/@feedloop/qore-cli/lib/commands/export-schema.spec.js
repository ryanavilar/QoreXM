"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const nock_record_1 = require("nock-record");
const fs_1 = tslib_1.__importDefault(require("fs"));
const path_1 = tslib_1.__importDefault(require("path"));
const export_schema_1 = tslib_1.__importDefault(require("./export-schema"));
const config_1 = tslib_1.__importDefault(require("../config"));
const record = nock_record_1.setupRecorder();
describe("export-schema", () => {
    beforeEach(() => {
        config_1.default.reset("org", "project", "token");
    });
    it("should be able to export schema", async () => {
        process.env.QORE_SERVER =
            "https://p-qore-dot-pti-feedloop.et.r.appspot.com";
        const { completeRecording } = await record("export-schema");
        await export_schema_1.default.run([
            "--project",
            "I0D3NimZQ9GKEDP",
            "--org",
            "lIdfC42DJCN2XzQ",
            "--token",
            "3960f3b8-a139-42eb-8295-3d669e4da4c9"
        ]);
        completeRecording();
        const filename = path_1.default.resolve(process.cwd() + "/qore.schema.json");
        expect(fs_1.default.readFileSync(filename, {
            encoding: "utf8"
        })).toMatchSnapshot();
        fs_1.default.unlinkSync(filename);
    });
});
